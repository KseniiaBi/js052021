<!DOCTYPE html>
<html lang="en">
<head>
	<title>JS FE</title> 
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1"> 

	<style>
	*{
		box-sizing: border-box;
		margin: 0;
		padding: 0;
	}


	body{
		padding: 30px;
	}

	.skill{
		display: inline-block;
	}
	.progressbar{
		width: 27vw;
		border: 1px solid black;
		height: 10px;
		border-radius: 5px;
		position: relative;
		margin-right: 2vw;
	}
	.progress{
		height: 100%;
		width: 0px;
		background: green;
	}

	#scroll{
		height: 2000px;
		background: yellow;
	}

	.count {
		position: absolute;
		top: 5px;
		right: -15px;
		font-size: 20px;
	}

	</style>
</head>
<body>

	<section id="scroll"></section>


	<section id="skills">
		<h2>My expertise</h2>

		<div class="skill">
			<h5>HTML</h5>
			<div class="progressbar">
				<div data-max="90" class="progress"></div>
				<span class="count"></span>
			</div>
		</div>

		<div class="skill">
			<h5>CSS</h5>
			<div class="progressbar">
				<div data-max="87" class="progress"></div>
				<span class="count"></span>
			</div>
		</div>

		<div class="skill">
			<h5>Javascript</h5>
			<div class="progressbar">
				<div data-max="60" class="progress"></div>
				<span class="count"></span>
			</div>
		</div>
	</section>
	<section id="scroll"></section>



<script>

	const targetScroll = document.querySelector('#scroll').offsetHeight;
	let progressIsAnimated = false;
	const progressbars = document.querySelectorAll('.progress');

	window.onscroll = () => {
		if(window.scrollY >= targetScroll && !progressIsAnimated){
			progressIsAnimated = true;
			for (let bar of progressbars){
				animateProgress(bar);
			}
		}
	}

	let scroll = document.scrollingElement.offsetTop;



	function animateProgress(el){
		let max = +el.dataset['max'];
		let count = el.parentNode.querySelector('.count');
		// let delta = max/100;
		let currentProgress = 0;

		let interval = setInterval(function(){
			if(currentProgress <= max){
				currentProgress += 1;
				count.innerText = currentProgress;
				el.style.width = currentProgress + '%';
			}
			else{
				clearInterval(interval);
			}
		}, 10);
	}

</script>

</body>
</html>
