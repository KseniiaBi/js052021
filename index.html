<!DOCTYPE html>
<html lang="en">
<head>
	<title>JS FE</title> 
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1"> 

	<style>
	*{
		box-sizing: border-box;
		margin: 0;
		padding: 0;
	}

	canvas {
		border: 1px solid #333;
		margin: 50px auto;
		display: block;
	}



	</style>
</head>
<body>

	<canvas width="500" height="350" id="game"></canvas>

<script>

	let canvas;
	let ctx;
	let c_height;
	let c_width;

	const balls = [];
	const maxBallsCount = 15;
	const maxRad = 20;
	const d_y = 3; // дельта для смещения позиции мяча
	const d_x = 3; // дельта для смещения позиции мяча

	function init(){
		canvas = document.querySelector('#game');
		ctx = canvas.getContext("2d");
		c_height = canvas.width;
		c_width = canvas.height;
	}

	init();

	function createBall(){
		let rad = Math.floor(Math.random()*maxRad);
		let red = Math.floor(Math.random()*155 + 100);
		let green = Math.floor(Math.random()*155 + 100);
		let blue = Math.floor(Math.random()*155 + 100);
		let color = `rgb(${red}, ${green}, ${blue})`;
		let ball = {
			radius: rad,
			color: color,
			ball_x: rad,
			ball_y: rad,
			ball_dx: 3,
			ball_dy: 3
		};
		console.log(rad);
		balls.push(ball);

		drawBall(rad,rad, rad, color);
	}

	function drawBall(x,y,r,col){
		ctx.fillStyle = col;
		ctx.beginPath();
		ctx.arc(x,y,r, 0, Math.PI*2);
		ctx.fill();
	}

	function update(){
		clearCanvas();

		balls.forEach(ball => {
		 	drawBall(ball.ball_x, ball.ball_y, ball.radius, ball.color);
		 	// debugger;
			if(ball.ball_x + ball.ball_dx >= c_height || ball.ball_x + ball.ball_dx < 0){
				
				ball.ball_dx = -ball.ball_dx;
			}
			if(ball.ball_y + ball.ball_dy  >= c_width || ball.ball_y + ball.ball_dy < 0){
				
				ball.ball_dy = -ball.ball_dy;
			}

			ball.ball_x += ball.ball_dx;
			ball.ball_y += ball.ball_dy;

		});
	}

	function clearCanvas(){
		ctx.clearRect(0,0, c_height, c_width);
	}



	setInterval(update, 15); // вызываем каждый кадр

	let interval = setInterval(function(){
		if(balls.length < maxBallsCount){
			createBall();
		}
		else{
			clearInterval(interval);
		}
	}, 1500);


</script>

</body>
</html>
