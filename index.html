<!DOCTYPE html>
<html lang="en">
<head>
	<title>JS FE</title> 
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1"> 

	<style>
	*{
		box-sizing: border-box;
		margin: 0;
		padding: 0;
	}

	.content{
		display: flex;
		flex-flow: row wrap;
		justify-content: space-evenly;
	}

	.coffee{
		width: 300px;
		text-align: center;
		border: 1px solid #e2e2e2;
		box-shadow: 2px 2px 0 #e2e2e2;
		margin: 20px;
	}

	h3{
		margin: 30px;
		font-size: 24px;
		color: #C3B091; 
	}

	h2{
		font-size: 44px;
		color: tomato; 
		text-align: right;
	}

	img{
		max-width: 90%;
	}

	</style>
</head>
<body>

	<div class="content">
		
	</div>


<script>


// создающий код
	let promise = new Promise((resolve, reject) => {
		// setTimeout(resolve, 500);
		setTimeout(reject, 1500);
	});

	// промисы не изменяют свое завершенное состояние - или он завершен успешно, или с ошибкой

// потребляющий - заменяет колбэки
	promise.then(function(result){
		console.log(111);
	}, function(error){
		// сделайте что-то что поможет разрешить промис удачно
		console.error('222');
	});

	// then(f(succ), f(err)) || then(null, f(err)) || then(f(succ))
	// catch(error)
	// promise.then().then().then().catch()
	// finally() - выполняется в любом случае promise.then().catch().finally()


	let p = new Promise((resolve, reject) => {
		confirm('Delete item?') ? resolve() : reject();
	});

	p.then(
		result => console.log('item was deleted'),
		reject => console.warn('item was not deleted')
	).catch(error => console.warn('Something went wrong'));

	const container = document.querySelector('.content');
	const url = 'data.json';


	let prom = new Promise((resolve, reject) => {

		let xhr = new XMLHttpRequest();
		xhr.open('GET', url); 
		xhr.send();
		xhr.onload = function(){
			if(xhr.status == 200){
				resolve(xhr.response);
			}
			else{
				reject(xhr.statusText);
			}
		} 
	});


	prom.then(data => {
		buildLayout(JSON.parse(data));
		console.log(data);
	}).catch(error => { // протестировать можно, допустив ошибку в url
		console.warn(error);
		container.innerHTML = error;
	});


	function buildLayout(d){
		d.forEach(item => {
			let div = document.createElement('div');
			div.classList.add('coffee');

			div.innerHTML = `<img src=${item.img} alt="coffee">
							<h3>${item.name}</h3>
							<h2>${item.price}</h2>`;

			container.append(div);
		});
	}

</script>

</body>
</html>
